# ビュフォンの針における円周率の導出

## 問題設定

平行な直線が、間隔 $h$（$h > \ell$）で引かれた平面上に、長さ $\ell$ の針をランダムに投げるとする。このとき、針が平行線と交わる確率 $P$ を計算し、これを利用して円周率 $\pi$ を導出する。

## モデル化

針の落下状態は、次の2つの独立な確率変数によって特徴づけられる：

* 針の中心が最近傍の線からの垂直距離 $y \in [0, h/2]$
* 針の傾き角（線と針のなす角）$\theta \in [0, \pi/2]$

ここで、針の中心が距離 $y$、角度 $\theta$ のときに針が線と交わる条件は、

$$
\frac{\ell}{2} \sin\theta \geq y
$$

である。

## 交差確率の導出

交差確率 $P$ は、上記の不等式を満たす $(y, \theta)$ の領域において一様分布の確率密度関数を積分することで得られる。すなわち：

$$
P = \frac{2}{h \pi} \int_{0}^{\pi/2} \int_{0}^{(\ell/2)\sin\theta} dy\, d\theta
$$

内積分を計算すると：

$$
\int_{0}^{(\ell/2)\sin\theta} dy = \frac{\ell}{2} \sin\theta
$$

したがって：

$$
P = \frac{2}{h \pi} \int_{0}^{\pi/2} \frac{\ell}{2} \sin\theta\, d\theta = \frac{\ell}{h \pi} \int_{0}^{\pi/2} \sin\theta\, d\theta
$$

$$
= \frac{\ell}{h \pi} [-\cos\theta]_{0}^{\pi/2} = \frac{\ell}{h \pi} (1 - 0) = \frac{\ell}{h \pi}
$$

## 円周率の導出

この結果を変形すると、交差確率 $P$ から円周率は以下のように表される：

$$
\pi = \frac{\ell}{h P}
$$

## 実験による推定

針を $N$ 回投げたときに、交差した回数を $C$ とすると、交差確率は $P \approx \frac{C}{N}$ と近似できる。よって：

$$
\pi \approx \frac{\ell N}{h C}
$$

この式により、試行回数 $N$ を増やすことで、円周率 $\pi$ の近似値が得られる。

---
